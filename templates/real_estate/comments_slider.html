{% load static %}
{% load humanize %}
<hr class="my-5">
<div class="container">
{% if comments %}
<!-- Swiper container -->
<div class="swiper mySwiper">
<div class="swiper-wrapper">
  {% for comment in comments %}
  <div class="swiper-slide">
    <div class="card shadow-sm border-0 rounded-4 p-4 h-100">

      <!-- User info -->
      <div class="d-flex align-items-center mb-3">
        <!-- Avatar -->
        <div class="avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"
             style="width:45px; height:45px; font-weight:600;">
          {{ comment.name|default:"–ê"|first|upper }}
        </div>

        <!-- Foydalanuvchi nomi faqat anonim ko'rinadi -->
        <div>
          <h6 class="mb-0">–ê–Ω–æ–Ω–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h6>
          <small class="text-muted">{{ comment.created_at|date:"d.m.Y H:i" }}</small>
        </div>
      </div>

      <!-- Izoh matni -->
      <p class="mb-2">{{ comment.text }}</p>

      <!-- Baholash yulduzlari -->
      {% with rating=comment.real_estate.ratings.last %}
        {% if rating %}
          <div class="mb-3">
            {% for i in "12345" %}
              {% if forloop.counter <= rating.rating %}
                <span class="text-warning">‚òÖ</span>
              {% else %}
                <span class="text-muted">‚òÖ</span>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ -->
      <div class="text-end">
        <a href="{% url 'real_estate_detail' comment.real_estate.id %}"
           class="text-decoration-none text-primary fw-semibold">
          üè† {{ comment.real_estate.title|default:comment.real_estate.get_type_display }}
        </a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Pagination & Navigation -->
<div class="swiper-pagination"></div>
<div class="swiper-button-next"></div>
<div class="swiper-button-prev"></div>
</div>
{% else %}
<p class="text-muted text-center">‚ùå –ü–æ–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç.</p>
{% endif %}

</div>

<!-- –û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π SwiperJS CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
var swiper = new Swiper(".mySwiper", {
loop: true,
autoplay: {
  delay: 4000,
  disableOnInteraction: false,
},
slidesPerView: 4,       // ‚ùó 1 sahifada 4 ta izoh ko'rinadi
spaceBetween: 20,       // ‚ùó kartalar orasidagi bo‚Äòshliq
pagination: {
  el: ".swiper-pagination",
  clickable: true,
},
navigation: {
  nextEl: ".swiper-button-next",
  prevEl: ".swiper-button-prev",
},
breakpoints: {
  0: {
    slidesPerView: 1,   // telefon
  },
  768: {
    slidesPerView: 2,   // planshet
  },
  992: {
    slidesPerView: 3,   // kichik laptop
  },
  1200: {
    slidesPerView: 4,   // katta ekran
  },
},
});
</script>
<hr style="margin:40px 0;">